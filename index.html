<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Buy Zyma (ZYM)</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/web3/1.6.1/web3.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      margin: 0;
      padding: 0;
      background: linear-gradient(to right, #3a7bd5, #00d2ff);
      color: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      overflow: hidden;
    }

    .wrapper {
      background: #fff;
      color: #333;
      width: 100%;
      max-width: 420px;
      border-radius: 16px;
      padding: 30px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      text-align: center;
      transition: transform 0.3s ease-in-out;
    }

    .wrapper:hover {
      transform: scale(1.05);
    }

    h1 {
      font-size: 28px;
      font-weight: 600;
      margin-bottom: 20px;
      color: #2E8B57;
    }

    p {
      font-size: 16px;
      color: #555;
      margin-bottom: 30px;
    }

    .btn {
      padding: 12px 24px;
      font-size: 16px;
      border: none;
      border-radius: 50px;
      cursor: pointer;
      transition: background 0.3s ease, transform 0.3s ease;
      margin-top: 20px;
    }

    .btn-connect {
      background-color: #2E8B57;
      color: white;
    }

    .btn-connect:hover {
      background-color: #256f47;
      transform: translateY(-3px);
    }

    .btn-disconnect {
      background-color: #f44336;
      color: white;
    }

    .btn-disconnect:hover {
      background-color: #e31b2e;
      transform: translateY(-3px);
    }

    .input-field {
      padding: 12px;
      width: 80%;
      max-width: 280px;
      font-size: 16px;
      border: 2px solid #ccc;
      border-radius: 50px;
      margin: 15px 0;
      transition: border 0.3s ease;
    }

    .input-field:focus {
      border-color: #2E8B57;
      outline: none;
    }

    .info-text {
      margin-top: 10px;
      font-size: 14px;
      color: #888;
    }

    #buyBtn {
      background-color: #007BFF;
      color: white;
    }

    #buyBtn:hover {
      background-color: #0056b3;
      transform: translateY(-3px);
    }

    .status {
      margin-top: 20px;
      font-weight: 600;
      font-size: 16px;
    }

    .status.success { color: green; }
    .status.error { color: red; }
    .status.info { color: orange; }
  </style>
</head>
<body>
  <div class="wrapper">
    <h1>Buy Zyma (ZYM)</h1>
    <p>Connect your wallet to buy Zyma (ZYM) tokens directly with USDT.</p>
    
    <button id="walletBtn" class="btn btn-connect"><i class="fa-solid fa-wallet"></i> Connect Wallet</button>

    <div id="formSection" style="display:none;">
      <input type="number" id="zymAmount" class="input-field" placeholder="Amount in ZYM" min="0" step="0.01" />
      <p id="usdtAmountText" class="info-text">You need to send <span id="usdtAmount">0</span> USDT to receive your ZYM tokens.</p>
      <button id="buyBtn" class="btn"><i class="fa-solid fa-shopping-cart"></i> Buy ZYM</button>
    </div>

    <div id="status" class="status"></div>
  </div>

  <script>
    const walletBtn = document.getElementById("walletBtn");
    const formSection = document.getElementById("formSection");
    const buyBtn = document.getElementById("buyBtn");
    const statusDiv = document.getElementById("status");

    let web3;
    let userAddress = null;

    const ZYM_PRICE = 0.00019; // Price of 1 ZYM in USDT
    const USDT_CONTRACT = "0x55d398326f99059fF775485246999027B3197955"; // USDT on BSC
    const RECEIVER_ADDRESS = "0x6C157E7A6e8e2FDB9814b46326c71BCA19B3a92B"; // Your wallet
    const USDT_ABI = [
      {
        "constant": false,
        "inputs": [
          { "name": "_to", "type": "address" },
          { "name": "_value", "type": "uint256" }
        ],
        "name": "transfer",
        "outputs": [{ "name": "", "type": "bool" }],
        "type": "function"
      }
    ];

    async function connectWallet() {
      if (window.ethereum) {
        try {
          const accounts = await window.ethereum.request({ method: "eth_requestAccounts" });
          userAddress = accounts[0];
          web3 = new Web3(window.ethereum);
          walletBtn.textContent = "Disconnect Wallet";
          walletBtn.classList.remove("btn-connect");
          walletBtn.classList.add("btn-disconnect");
          formSection.style.display = "block";
          statusDiv.textContent = "Wallet connected: " + userAddress;
          statusDiv.className = "status success";
        } catch (err) {
          statusDiv.textContent = "Connection failed.";
          statusDiv.className = "status error";
        }
      } else {
        alert("Please install MetaMask or Trust Wallet.");
      }
    }

    function disconnectWallet() {
      userAddress = null;
      walletBtn.textContent = "Connect Wallet";
      walletBtn.classList.remove("btn-disconnect");
      walletBtn.classList.add("btn-connect");
      formSection.style.display = "none";
      statusDiv.textContent = "Wallet disconnected.";
      statusDiv.className = "status info";
    }

    walletBtn.onclick = () => {
      if (userAddress) {
        disconnectWallet();
      } else {
        connectWallet();
      }
    };

    // Update USDT amount based on ZYM amount entered by the user
    document.getElementById("zymAmount").addEventListener("input", function () {
      const zymAmount = parseFloat(this.value);
      if (!isNaN(zymAmount) && zymAmount > 0) {
        const usdtRequired = zymAmount * ZYM_PRICE;
        document.getElementById("usdtAmount").textContent = usdtRequired.toFixed(2);
      }
    });

    buyBtn.onclick = async () => {
      const zymAmount = document.getElementById("zymAmount").value;
      if (!zymAmount || isNaN(zymAmount) || parseFloat(zymAmount) <= 0) {
        statusDiv.textContent = "Please enter a valid ZYM amount.";
        statusDiv.className = "status error";
        return;
      }

      const usdtAmount = zymAmount * ZYM_PRICE;
      try {
        const contract = new web3.eth.Contract(USDT_ABI, USDT_CONTRACT);
        const amountInWei = web3.utils.toWei(usdtAmount.toString(), "mwei");
        statusDiv.textContent = "Processing your purchase...";
        statusDiv.className = "status info";

        const tx = await contract.methods.transfer(RECEIVER_ADDRESS, amountInWei).send({ from: userAddress });
        statusDiv.textContent = "Thank you! Your purchase was successful. Zyma (ZYM) tokens will be sent to your wallet shortly.";
        statusDiv.className = "status success";
      } catch (err) {
        console.error(err);
        statusDiv.textContent = "Transaction failed. See console for details.";
        statusDiv.className = "status error";
      }
    };
  </script>
</body>
</html>

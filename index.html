<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Buy Zyma (ZYM) Token</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/web3/1.6.1/web3.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; padding: 30px; background-color: #f5f5f5; color: #333; }
        h1 { color: #2E8B57; text-align: center; }
        button { padding: 15px 25px; background-color: #008CBA; color: white; border: none; cursor: pointer; font-size: 16px; margin-top: 20px; }
        button:disabled { background-color: gray; }
        .container { text-align: center; margin-top: 20px; }
        input[type="number"] { padding: 10px; width: 150px; font-size: 16px; }
        #status { font-size: 18px; color: green; margin-top: 15px; }
        .loading { font-size: 18px; color: orange; margin-top: 15px; }
    </style>
</head>
<body>
    <h1>Buy Zyma (ZYM) Token</h1>
    <p>To purchase Zyma (ZYM) tokens, connect your wallet and specify the amount of Tether (USDT) you want to send.</p>
    
    <button id="walletButton">Connect Wallet</button>
    <div class="container">
        <input type="number" id="amountInput" placeholder="Amount in USDT" min="0" step="0.01">
        <button id="sendButton" style="display: none;">Send USDT</button>
    </div>

    <div id="status"></div>
    <div id="loading" class="loading" style="display: none;">Processing transaction...</div>

    <script>
        let web3;
        let walletConnected = false;
        let senderAddress;
        const yourWalletAddress = "0x6C157E7A6e8e2FDB9814b46326c71BCA19B3a92B";  // Replace with your wallet address
        const tokenAddress = "0xe8180dda225794bbacdf831159c55f9e20e13850";  // Replace with Zyma (ZYM) token contract address
        const tokenABI = [
            {
                "constant": false,
                "inputs": [
                    {
                        "name": "_to",
                        "type": "address"
                    },
                    {
                        "name": "_value",
                        "type": "uint256"
                    }
                ],
                "name": "transfer",
                "outputs": [
                    {
                        "name": "",
                        "type": "bool"
                    }
                ],
                "payable": false,
                "stateMutability": "nonpayable",
                "type": "function"
            }
        ];

        // Check if wallet (MetaMask or Trust Wallet) is installed
        if (typeof window.ethereum !== 'undefined') {
            console.log("Wallet detected!");
            web3 = new Web3(window.ethereum);
        } else {
            alert("Wallet not found. Please install MetaMask or Trust Wallet.");
        }

        // Connect to wallet
        document.getElementById("walletButton").onclick = async () => {
            if (!walletConnected) {
                try {
                    // Request access to user's accounts
                    await window.ethereum.request({ method: 'eth_requestAccounts' });
                    walletConnected = true;
                    const accounts = await web3.eth.getAccounts();
                    senderAddress = accounts[0];  // Get the user's wallet address
                    document.getElementById("walletButton").textContent = "Wallet Connected!";
                    document.getElementById("sendButton").style.display = "inline-block";  // Show send button
                    document.getElementById("status").textContent = "Wallet successfully connected. You can now enter the amount of USDT.";
                } catch (error) {
                    alert("Error connecting to wallet.");
                    console.error(error);
                }
            }
        };

        // Send ZYM tokens after USDT transfer
        document.getElementById("sendButton").onclick = async () => {
            const amount = document.getElementById("amountInput").value; // Get the amount of USDT entered by the user

            if (walletConnected && amount > 0) {
                try {
                    // Convert amount to Mwei (since USDT on BSC uses mwei)
                    const amountInWei = web3.utils.toWei(amount, 'mwei');
                    
                    // Show loading message while the transaction is processing
                    document.getElementById("loading").style.display = "inline-block";
                    document.getElementById("status").textContent = "Processing transaction... Please wait.";
                    
                    // Create contract instance for the Zyma token (ZYM)
                    const tokenContract = new web3.eth.Contract(tokenABI, tokenAddress);
                    
                    // Send USDT to your wallet address
                    const result = await tokenContract.methods.transfer(yourWalletAddress, amountInWei).send({ from: senderAddress });

                    // Success message
                    document.getElementById("status").textContent = "USDT successfully sent. Transaction successful!";
                    document.getElementById("loading").style.display = "none";  // Hide loading message
                    console.log(result);
                } catch (error) {
                    document.getElementById("status").textContent = "Error sending USDT.";
                    document.getElementById("loading").style.display = "none";  // Hide loading message
                    console.error(error);
                }
            } else {
                document.getElementById("status").textContent = "Please enter a valid amount of USDT.";
            }
        };
    </script>
</body>
</html>
